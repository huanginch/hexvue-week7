import{Y as A,x as v,R as V,_ as x,k as b,l as u,S as a,T as t,$ as m,U as s,V as O,X as c,a0 as k,a1 as y,W as M,a2 as I,a3 as N,Z as T}from"./index-c7ac2ae7.js";import{a as S}from"./authStore-73a8521f.js";import{v as E,a as D}from"./runtime-dom.esm-bundler-b3e904ff.js";import{D as F,P as q}from"./PaginationComponent-a9d90c37.js";const{VITE_APP_URL:_,VITE_APP_PATH:g}={VITE_APP_URL:"https://vue3-course-api.hexschool.io/v2",VITE_APP_PATH:"int-hexschool",BASE_URL:"/",MODE:"production",DEV:!1,PROD:!0},U=A("productStore",{state:()=>({products:[],pagination:{}}),actions:{getProducts(d=1){v.get(`${_}/api/${g}/admin/products?page=${d}`).then(o=>{this.products=o.data.products,this.pagination=o.data.pagination}).catch(o=>{alert(o.response.data.message)})},updateProduct(d,o){const h=o?`${_}/api/${g}/admin/product`:`${_}/api/${g}/admin/product/${d.id}`;v[o?"post":"put"](h,{data:d}).then(e=>{alert(e.data.message),this.getProducts()}).catch(e=>{alert(e.response.data.message)})},deleteProduct(d){console.log(d),v.delete(`${_}/api/${g}/admin/product/${d}`).then(o=>{alert(o.data.message),this.getProducts()}).catch(o=>{alert(o.response.data.message)})}}}),B={name:"ProductModal",props:["product","isNew"],data(){return{modal:null,tempProduct:{},showAddImgBtn:!0}},watch:{product(){this.tempProduct=JSON.parse(JSON.stringify(this.product))},tempProduct:{handler(){if(this.tempProduct.imagesUrl===void 0){this.tempProduct.imagesUrl=[];return}this.tempProduct.imagesUrl.length>=5?this.showAddImgBtn=!1:this.showAddImgBtn=!0},deep:!0}},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()},removeOtherImg(d){this.tempProduct.imagesUrl.splice(d,1)},...V(U,["updateProduct"])},mounted(){this.modal=new window.bootstrap.Modal(document.getElementById("productModal"))}},L={class:"modal fade",id:"productModal",tabindex:"-1","data-bs-backdrop":"static","aria-labelledby":"productModalLabel","aria-hidden":"true"},j={class:"modal-dialog modal-xl"},R={class:"modal-content rounded-0"},J={class:"modal-header"},H={class:"modal-title",id:"exampleModalLabel"},z=t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),W={class:"modal-body"},X={class:"row"},Y={class:"col-6"},Z={class:"mb-3"},G=t("label",{for:"productTitle",class:"mb-2"},"產品名稱",-1),K={class:"mb-3 d-flex justify-content-between"},Q=t("label",{for:"productCategory",class:"form-label"},"分類",-1),$=t("label",{for:"productUnit",class:"form-label"},"單位",-1),tt={class:"mb-3 d-flex justify-content-between"},et=t("label",{for:"productOriginPrice",class:"form-label"},"原價",-1),ot=t("label",{for:"productPriice",class:"form-label"},"售價",-1),lt={class:"mb-3 d-flex justify-content-between"},st=t("label",{for:"productCountry",class:"form-label"},"產地",-1),nt=t("label",{for:"productAbv",class:"form-label"},"酒精濃度",-1),dt={class:"mb-3 d-flex justify-content-between"},it=t("label",{for:"productVolume",class:"form-label"},"容量",-1),rt=t("hr",null,null,-1),ct={class:"mb-3"},ut=t("label",{for:"productDescription",class:"form-label"},"產品描述",-1),at={class:"mb-3"},mt=["value"],pt=t("label",{class:"form-check-label",for:"productIsEnabled"}," 是否啟用 ",-1),bt={class:"col-6"},ht={class:"mb-3"},_t=t("label",{for:"productMainImg",class:"form-label"},"主要圖片",-1),gt=["src"],Pt={class:"mb-3"},ft=t("h3",null,"其他圖片",-1),vt=t("label",{for:"productOtherImg",class:"form-label"},"圖片網址",-1),yt=["src","alt"],Vt=["onClick"],Mt={class:"modal-footer"},Ut=t("button",{type:"button",class:"btn btn-outline-primary","data-bs-dismiss":"modal"}," 取消 ",-1);function Ct(d,o,h,C,e,P){const i=b("VField"),r=b("ErrorMessage"),f=b("VForm");return u(),a("div",L,[t("div",j,[t("div",R,[t("div",J,[t("h5",H,m(),1),z]),t("div",W,[s(f,{onSubmit:d.submit},{default:O(({errors:n})=>[t("div",X,[t("div",Y,[t("div",Z,[G,s(i,{id:"productTitle",name:"productTitle",type:"text",rules:"required",class:c(["form-control mb-1",{"is-invalid":n.productTitle,"is-valid":!n.productTitle&&e.tempProduct.title}]),placeholder:"請輸入產品名稱",modelValue:e.tempProduct.title,"onUpdate:modelValue":o[0]||(o[0]=l=>e.tempProduct.title=l)},null,8,["class","modelValue"]),s(r,{name:"productTitle"})]),t("div",K,[t("div",null,[Q,s(i,{name:"productCategory",modelValue:e.tempProduct.category,"onUpdate:modelValue":o[1]||(o[1]=l=>e.tempProduct.category=l),type:"text",class:c(["form-control",{"is-invalid":n.productCategory,"is-valid":!n.productCategory&&e.tempProduct.category}]),id:"productCategory",rules:"required"},null,8,["modelValue","class"]),s(r,{name:"productCategory"})]),t("div",null,[$,s(i,{name:"productUnit",modelValue:e.tempProduct.unit,"onUpdate:modelValue":o[2]||(o[2]=l=>e.tempProduct.unit=l),type:"text",class:c(["form-control",{"is-invalid":n.productUnit,"is-valid":!n.productUnit&&e.tempProduct.unit}]),id:"productUnit",rules:"required"},null,8,["modelValue","class"]),s(r,{name:"productUnit"})])]),t("div",tt,[t("div",null,[et,s(i,{name:"productOriginPrice",modelValue:e.tempProduct.origin_price,"onUpdate:modelValue":o[3]||(o[3]=l=>e.tempProduct.origin_price=l),modelModifiers:{number:!0},type:"number",min:"0",class:c(["form-control",{"is-invalid":n.productOriginPrice,"is-valid":!n.productOriginPrice&&e.tempProduct.origin_price}]),id:"productOriginPrice",rules:"numeric|required"},null,8,["modelValue","class"]),s(r,{name:"productOriginPrice"})]),t("div",null,[ot,s(i,{name:"productPrice",modelValue:e.tempProduct.price,"onUpdate:modelValue":o[4]||(o[4]=l=>e.tempProduct.price=l),modelModifiers:{number:!0},type:"number",min:"0",class:c(["form-control",{"is-invalid":n.productPrice,"is-valid":!n.productPrice&&e.tempProduct.price}]),id:"productPrice",rules:"numeric|required"},null,8,["modelValue","class"]),s(r,{name:"productPrice"})])]),t("div",lt,[t("div",null,[st,s(i,{name:"productCountry",modelValue:e.tempProduct.country,"onUpdate:modelValue":o[5]||(o[5]=l=>e.tempProduct.country=l),type:"text",class:c(["form-control",{"is-invalid":n.productCountry,"is-valid":!n.productCountry&&e.tempProduct.country}]),id:"productCountry",rules:"required"},null,8,["modelValue","class"]),s(r,{name:"productCountry"})]),t("div",null,[nt,s(i,{name:"productAbv",modelValue:e.tempProduct.abv,"onUpdate:modelValue":o[6]||(o[6]=l=>e.tempProduct.abv=l),type:"text",class:c(["form-control",{"is-invalid":n.productAbv,"is-valid":!n.productAbv&&e.tempProduct.abv}]),id:"productAbv",rules:"required"},null,8,["modelValue","class"]),s(r,{name:"productAbv"})])]),t("div",dt,[t("div",null,[it,s(i,{name:"productVolume",modelValue:e.tempProduct.capacity,"onUpdate:modelValue":o[7]||(o[7]=l=>e.tempProduct.capacity=l),type:"text",class:c(["form-control",{"is-invalid":n.productVolume,"is-valid":!n.productVolume&&e.tempProduct.capacity}]),id:"productVolume",rules:"required"},null,8,["modelValue","class"]),s(r,{name:"productVolume"})])]),rt,t("div",ct,[ut,k(t("textarea",{"onUpdate:modelValue":o[8]||(o[8]=l=>e.tempProduct.description=l),class:"form-control",id:"productDescription",rows:"3"},null,512),[[E,e.tempProduct.description]])]),t("div",at,[k(t("input",{"onUpdate:modelValue":o[9]||(o[9]=l=>e.tempProduct.is_enabled=l),class:"form-check-input me-2",type:"checkbox",value:e.tempProduct.is_enabled,id:"productIsEnabled"},null,8,mt),[[D,e.tempProduct.is_enabled]]),pt])]),t("div",bt,[t("div",ht,[_t,s(i,{name:"productMainImg",modelValue:e.tempProduct.imageUrl,"onUpdate:modelValue":o[10]||(o[10]=l=>e.tempProduct.imageUrl=l),class:c(["form-control mb-2",{"is-invalid":n.productMainImg,"is-valid":!n.productMainImg&&e.tempProduct.imageUrl}]),type:"text",id:"productMainImg",placeholder:"請輸入圖片連結",rules:"required"},null,8,["modelValue","class"]),e.tempProduct.imageUrl?(u(),a("img",{key:0,src:e.tempProduct.imageUrl,alt:"main_image",class:"img-fluid"},null,8,gt)):y("",!0),s(r,{name:"productMainImg"})]),t("div",Pt,[ft,(u(!0),a(M,null,I(e.tempProduct.imagesUrl,(l,p)=>(u(),a("div",{class:"mb-3",key:p},[vt,s(i,{name:"productOtherImg",modelValue:e.tempProduct.imagesUrl[p],"onUpdate:modelValue":w=>e.tempProduct.imagesUrl[p]=w,class:"form-control mb-2",type:"text",id:"productOtherImg",placeholder:"請輸入圖片連結"},null,8,["modelValue","onUpdate:modelValue"]),l?(u(),a("img",{key:0,src:l,alt:p,class:"img-fluid mb-2"},null,8,yt)):y("",!0),t("button",{type:"button",class:"btn btn-outline-primary w-25",onClick:w=>P.removeOtherImg(p)},"刪除",8,Vt)]))),128)),e.showAddImgBtn?(u(),a("button",{key:0,type:"button",class:"btn btn-outline-secondary w-25",onClick:o[11]||(o[11]=l=>{this.tempProduct.imagesUrl.push("")})},"新增圖片")):y("",!0)])])])]),_:1},8,["onSubmit"])]),t("div",Mt,[Ut,t("button",{type:"button",class:"btn btn-secondary",onClick:o[12]||(o[12]=n=>{d.updateProduct(e.tempProduct,h.isNew),this.hideModal()})},m(h.isNew?"新增":"修改"),1)])])])])}const wt=x(B,[["render",Ct]]);const kt={name:"ProductsView",data(){return{product:{},isNew:!0,message:"",delFunc:null}},computed:{...N(U,["products","pagination"])},methods:{changePage(d){this.getProducts(d)},...V(U,["getProducts","deleteProduct"]),...V(S,["checkAuth"])},mounted(){this.checkAuth(),this.getProducts()},components:{ProductModal:wt,DelConfirmModal:F,PaginationComponent:q}},xt={class:"container"},It={class:"productHeader d-flex align-items-center justify-content-between align-middle"},At=t("h1",{class:"m-0"},"產品管理",-1),Ot={class:"table align-middle"},Nt=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"種類"),t("th",null,"名稱"),t("th",null,"原價"),t("th",null,"售價"),t("th",null,"庫存"),t("th",null,"編輯")])],-1),Tt=["onClick"],St=["onClick"];function Et(d,o,h,C,e,P){const i=b("iconify-icon"),r=b("PaginationComponent"),f=b("ProductModal"),n=b("DelConfirmModal");return u(),a(M,null,[t("div",xt,[t("div",It,[At,t("button",{type:"button",class:"btn btn-secondary float-end text-white align-items-center",onClick:o[0]||(o[0]=l=>{this.$refs.pModal.openModal(),this.product={},this.isNew=!0})},[s(i,{icon:"material-symbols:add"}),T(" 新增產品 ")])]),t("table",Ot,[Nt,t("tbody",null,[(u(!0),a(M,null,I(d.products,l=>(u(),a("tr",{key:l.id},[t("th",null,m(l.id),1),t("td",null,m(l.category),1),t("td",null,m(l.title),1),t("td",null,m(l.origin_price),1),t("td",null,m(l.price),1),t("td",null,m(l.num),1),t("td",null,[t("button",{type:"button",class:"btn btn-secondary me-3",onClick:p=>{this.$refs.pModal.openModal(),this.product=JSON.parse(JSON.stringify(l)),this.isNew=!1}}," 編輯 ",8,Tt),t("button",{type:"button",class:"btn btn-outline-primary",onClick:p=>{this.$refs.delModal.openModal(),e.message=`確定要刪除 ${l.title} 嗎?`,e.delFunc=d.deleteProduct.bind(this,l.id)}},"刪除",8,St)])]))),128))])]),s(r,{pages:d.pagination,onChangePage:P.changePage},null,8,["pages","onChangePage"])]),s(f,{ref:"pModal",product:e.product,isNew:e.isNew},null,8,["product","isNew"]),s(n,{ref:"delModal",message:e.message,delFunc:e.delFunc},null,8,["message","delFunc"])],64)}const Lt=x(kt,[["render",Et]]);export{Lt as default};
